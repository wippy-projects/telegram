$schema: 'https://raw.githubusercontent.com/context-hub/generator/refs/heads/main/json-schema.json'

import:
  - url: https://gist.githubusercontent.com/butschster/29e84fb9c976ac837181141f88049a35/raw/ed38539950f8c9c45ca8c67f9e026a837c97bc66/01-dev-prompts.yaml
    type: url

projects:
  - name: examples
    path: ../examples
    description: Wippy examples

exclude:
  patterns:
    - ".env*"
  paths:
    - ".claude"
    - ".context"
    - ".build"
    - ".wippy"
    - "runtime"

tools:
  # ============================================================================
  # Wippy Linter - Type checking and static analysis
  # ============================================================================
  - id: wippy-lint-ns
    description: |
      Lint a specific namespace only.
      Useful for checking changes in a particular module.
    type: run
    schema:
      type: object
      properties:
        namespace:
          type: string
          description: "Namespace to check (e.g., 'app', 'app.api', 'app.*')"
      required: [ namespace ]
    commands:
      - cmd: wippy
        args: [ lint, "--ns={{namespace}}" ]

  # ============================================================================
  # Table of Contents - Browse documentation structure
  # ============================================================================
  - id: wippy-toc
    description: |
      Get the complete table of contents for Wippy documentation.
      Returns JSON structure of all available documentation pages.
      Use this to discover available topics and their paths.
    type: http
    requests:
      - url: "https://home.wj.wippy.ai/llm/toc"
        method: "GET"
        headers:
          Accept: "application/json"

  # ============================================================================
  # Search - Find content by query
  # ============================================================================
  - id: wippy-search
    description: |
      Search Wippy documentation for specific topics, functions, or concepts.
      Returns chunk IDs that can be used with wippy-chunk or wippy-related tools.
      Examples: "actor model", "http server", "process spawn", "sql query"
    type: http
    schema:
      type: object
      properties:
        query:
          type: string
          description: "Search query (e.g., 'http routing', 'process model', 'sql')"
      required: [ "query" ]
    requests:
      - url: "https://home.wj.wippy.ai/llm/search"
        method: "GET"
        headers:
          Accept: "application/json"
        query:
          q: "{{query}}"

  # ============================================================================
  # Fetch Page - Get full page content
  # ============================================================================
  - id: wippy-page
    description: |
      Fetch full content of a documentation page by its path.
      Use paths from TOC or search results (e.g., 'lua/core/process', 'http/server').
      Common paths:
        - start/about, start/structure
        - lua/core/process, lua/core/channel, lua/core/funcs
        - lua/storage/sql, lua/storage/store
        - lua/http/http, lua/http/client
        - http/server, http/router, http/endpoint
        - guides/supervision, guides/configuration
        - concepts/process-model, concepts/registry
    type: http
    schema:
      type: object
      properties:
        path:
          type: string
          description: "Documentation path (e.g., 'lua/core/process', 'http/server')"
      required: [ "path" ]
    requests:
      - url: "https://home.wj.wippy.ai/llm/path/en/{{path}}"
        method: "GET"
        headers:
          Accept: "text/plain"

  # ============================================================================
  # Summary - Quick overview of a page
  # ============================================================================
  - id: wippy-summary
    description: |
      Get a quick summary/overview of a documentation page with section summaries.
      Useful for understanding page structure before fetching full content.
      Uses same paths as wippy-page tool.
    type: http
    schema:
      type: object
      properties:
        path:
          type: string
          description: "Documentation path (e.g., 'lua/core/process', 'http/server')"
      required: [ "path" ]
    requests:
      - url: "https://home.wj.wippy.ai/llm/summary/en/{{path}}"
        method: "GET"
        headers:
          Accept: "text/plain"

  # ============================================================================
  # Batch Fetch - Get multiple pages at once
  # ============================================================================
  - id: wippy-context
    description: |
      Batch fetch multiple documentation pages in a single request.
      Efficient for gathering related documentation.
      Paths should be comma-separated (e.g., 'lua/core/process,lua/core/channel').
    type: http
    schema:
      type: object
      properties:
        paths:
          type: string
          description: "Comma-separated paths (e.g., 'lua/core/process,lua/core/channel,http/server')"
      required: [ "paths" ]
    requests:
      - url: "https://home.wj.wippy.ai/llm/context"
        method: "GET"
        headers:
          Accept: "text/plain"
        query:
          paths: "{{paths}}"

  # ============================================================================
  # Chunk - Get specific chunk by ID
  # ============================================================================
  - id: wippy-chunk
    description: |
      Get a specific documentation chunk by its ID.
      Chunk IDs are returned from search results in format 'path#anchor'.
      Example IDs: 'http/routing#middleware', 'lua/core/process#spawn'
    type: http
    schema:
      type: object
      properties:
        id:
          type: string
          description: "Chunk ID from search results (e.g., 'http/routing#middleware')"
      required: [ "id" ]
    requests:
      - url: "https://home.wj.wippy.ai/llm/chunk/{{id}}"
        method: "GET"
        headers:
          Accept: "text/plain"

  # ============================================================================
  # Related - Find related content
  # ============================================================================
  - id: wippy-related
    description: |
      Find content related to a specific chunk ID.
      Useful for discovering similar topics or linked documentation.
      Takes chunk IDs in format 'path#anchor'.
    type: http
    schema:
      type: object
      properties:
        id:
          type: string
          description: "Chunk ID to find related content for (e.g., 'lua/core/process#spawn')"
      required: [ "id" ]
    requests:
      - url: "https://home.wj.wippy.ai/llm/related/{{id}}"
        method: "GET"
        headers:
          Accept: "application/json"